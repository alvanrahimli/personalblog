<!doctype html><html lang=en>
<head>
<title>OS-Dev Notes #1 :: Alvan's Blog</title>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=description content="OS-DEV notes #1 8086 Segment Registers: To access memory adresses more than 16 bit (65535) we use &amp;lsquo;Segment Registers&amp;rsquo;
It is always appreciated to remove interrupts (cli), reset segment registers, then set interrupts (sli) before bootloader starts.
 CS =&amp;gt; Code Segment SS =&amp;gt; Stack Segment DS =&amp;gt; Data Segment ES =&amp;gt; Extra Segment  Final memory address is calculated as:
final address = Segment Register * 16 + offset">
<meta name=keywords content="tech blog alvan alvanrahimli rahimli dotnet developer c# razor pages golang go">
<meta name=robots content="noodp">
<link rel=canonical href=/posts/os-dev-notes-1/>
<link rel=stylesheet href=/assets/style.css>
<link rel=apple-touch-icon href=/img/apple-touch-icon-192x192.png>
<link rel="shortcut icon" href=/img/favicon/orange.png>
<meta name=twitter:card content="summary">
<meta name=twitter:site content>
<meta name=twitter:creator content="Alvan Rahimli">
<meta property="og:locale" content="en">
<meta property="og:type" content="article">
<meta property="og:title" content="OS-Dev Notes #1">
<meta property="og:description" content="OS-DEV notes #1 8086 Segment Registers: To access memory adresses more than 16 bit (65535) we use &amp;lsquo;Segment Registers&amp;rsquo;
It is always appreciated to remove interrupts (cli), reset segment registers, then set interrupts (sli) before bootloader starts.
 CS =&amp;gt; Code Segment SS =&amp;gt; Stack Segment DS =&amp;gt; Data Segment ES =&amp;gt; Extra Segment  Final memory address is calculated as:
final address = Segment Register * 16 + offset">
<meta property="og:url" content="/posts/os-dev-notes-1/">
<meta property="og:site_name" content="Alvan's Blog">
<meta property="og:image" content="/img/favicon/orange.png">
<meta property="og:image:width" content="2048">
<meta property="og:image:height" content="1024">
<meta property="article:published_time" content="2021-10-01 14:19:49 +0000 UTC">
</head>
<body class=orange>
<div class="container center headings--one-size">
<header class=header>
<div class=header__inner>
<div class=header__logo>
<a href=/>
<div class=logo>
Alvan's Blog
</div>
</a>
</div>
<div class=menu-trigger>menu</div>
</div>
<nav class=menu>
<ul class="menu__inner menu__inner--desktop">
<li><a href=/posts/about-me>About me</a></li>
<li><a href=https://cv.rahim.li/>Look at my CV</a></li>
</ul>
<ul class="menu__inner menu__inner--mobile">
<li><a href=/posts/about-me>About me</a></li>
<li><a href=https://cv.rahim.li/>Look at my CV</a></li>
</ul>
</nav>
</header>
<div class=content>
<div class=post>
<h1 class=post-title>
<a href=/posts/os-dev-notes-1/>OS-Dev Notes #1</a></h1>
<div class=post-meta>
<span class=post-date>
2021-10-01
[Updated: 2021-10-01]
</span>
<span class=post-author>:: Alvan Rahimli</span>
</div>
<div class=post-content><div>
<h1 id=os-dev-notes-1>OS-DEV notes #1<a href=#os-dev-notes-1 class=hanchor arialabel=Anchor>&#8983;</a> </h1>
<h2 id=8086-segment-registers>8086 Segment Registers:<a href=#8086-segment-registers class=hanchor arialabel=Anchor>&#8983;</a> </h2>
<p>To access memory adresses more than 16 bit (65535) we use &lsquo;Segment Registers&rsquo;<br>
It is always appreciated to remove interrupts (<code>cli</code>), reset segment registers, then set interrupts (<code>sli</code>) before bootloader starts.</p>
<ul>
<li>CS => Code Segment</li>
<li>SS => Stack Segment</li>
<li>DS => Data Segment</li>
<li>ES => Extra Segment</li>
</ul>
<p>Final memory address is calculated as:<br>
<code>final address = Segment Register * 16 + offset</code></p>
<p>In the example below, <code>lodsb</code> knows that, address it must read is <code>0x7c * 16 + 0x1f</code>, as <code>lodsb</code> uses Data Segment</p>
<pre tabindex=0><code>org 0
mov ax, 0x7c
mov ds, ax
mov si, 0x1f
lodsb           ; LODSB uses Data Segment for segmentation
</code></pre><p>The table below demonstrates LOD__ command usage:</p>
<table>
<thead>
<tr>
<th>Code</th>
<th>Mnemonic</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>AC</td>
<td>LODS m8</td>
<td>Load byte at address DS:(E)SI into AL</td>
</tr>
<tr>
<td>AD</td>
<td>LODS m16</td>
<td>Load word at address DS:(E)SI into AX</td>
</tr>
<tr>
<td>AD</td>
<td>LODS m32</td>
<td>Load double-word at address DS:(E)SI into EAX</td>
</tr>
<tr>
<td>AC</td>
<td>LODSB</td>
<td>Load byte at address DS:(E)SI into AL</td>
</tr>
<tr>
<td>AD</td>
<td>LODSW</td>
<td>Load word at address DS:(E)SI into AX</td>
</tr>
<tr>
<td>AD</td>
<td>LODSD</td>
<td>Load double-word at address DS:(E)SI into EAX</td>
</tr>
</tbody>
</table>
<p>Stack Segmentation example:<br>
At the code below, when we <strong>push 0xffff</strong> to stack, stack pointer is
decremented by 2 (bc, we use 16 bit) and <code>sp == 0x7bfe</code>.<br>
Then, memory at adress <strong>0x7bfe</strong> is set to <strong>0xffff</strong>.</p>
<pre tabindex=0><code>mov ax, 0x00    ; Set ax to 0x00
mov ss, ax      ; Move value in ax to 'stack segment'
mov ax, 0x7c00  ; Add ax to 0x7c00
mov sp, ax      ; Move AX to 'stack pointer'

push 0xffff     ; Pushes 0xffff to the stack
</code></pre>
</div></div>
<div class=pagination>
<div class=pagination__title>
<span class=pagination__title-h>Read other posts</span>
<hr>
</div>
<div class=pagination__buttons>
<span class="button previous">
<a href=/posts/2021/status-update-1/>
<span class=button__icon>←</span>
<span class=button__text>Status Update | 14 Nov 2021</span>
</a>
</span>
<span class="button next">
<a href=/posts/non-functional-requirements/>
<span class=button__text>Non-Functional Requirements</span>
<span class=button__icon>→</span>
</a>
</span>
</div>
</div>
</div>
</div>
<footer class=footer>
<div class=footer__inner>
<div class=copyright>
<span>© 2021 Powered by <a href=http://gohugo.io>Hugo</a></span>
<span>:: Theme made by <a href=https://twitter.com/panr>panr</a></span>
</div>
</div>
</footer>
<script src=/assets/main.js></script>
<script src=/assets/prism.js></script>
</div>
</body>
</html>